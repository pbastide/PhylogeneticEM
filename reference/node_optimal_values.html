<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computation of the optimal values at nodes and tips. — node_optimal_values • PhylogeneticEM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computation of the optimal values at nodes and tips. — node_optimal_values"><meta name="description" content="compute_betas_from_shifts computes the optimal values at the nodes and tips of the
tree, given the value at the root and the list of shifts occurring in the tree.
It assumes an OU model."><meta property="og:description" content="compute_betas_from_shifts computes the optimal values at the nodes and tips of the
tree, given the value at the root and the list of shifts occurring in the tree.
It assumes an OU model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhylogeneticEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tutorial.html">Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/monkeys.html">New World Monkeys</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbastide/PhylogeneticEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computation of the optimal values at nodes and tips.</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbastide/PhylogeneticEM/blob/v1.8.0/R/shifts_manipulations.R" class="external-link"><code>R/shifts_manipulations.R</code></a></small>
      <div class="d-none name"><code>node_optimal_values.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>compute_betas_from_shifts</code> computes the optimal values at the nodes and tips of the
tree, given the value at the root and the list of shifts occurring in the tree.
It assumes an OU model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">node_optimal_values</span><span class="op">(</span><span class="va">param</span>, <span class="va">phylo</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>an object of class <code><a href="params_process.html">params_process</a></code>.</p></dd>


<dt id="arg-phylo">phylo<a class="anchor" aria-label="anchor" href="#arg-phylo"></a></dt>
<dd><p>a phylogenetic tree, class <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">phylo</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Matrix of size ntraits  x (ntaxa + Nnode) of the optimal values at
the node and tips of the tree.
Column names correspond to the number of the node in the phylo object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1792</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ntaxa</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">rphylo</span><span class="op">(</span><span class="va">ntaxa</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># parameters of the process</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="params_process.html">params_process</a></span><span class="op">(</span><span class="st">"BM"</span>,                             <span class="co">## Process</span></span></span>
<span class="r-in"><span>                      p <span class="op">=</span> <span class="fl">2</span>,                            <span class="co">## Dimension</span></span></span>
<span class="r-in"><span>                      variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>, <span class="co">## Rate matrix</span></span></span>
<span class="r-in"><span>                      edges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span>,             <span class="co">## Positions of the shifts</span></span></span>
<span class="r-in"><span>                      values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span>,           <span class="co">## Values of the shifts</span></span></span>
<span class="r-in"><span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">par</span>, phylo <span class="op">=</span> <span class="va">tree</span>, traits <span class="op">=</span> <span class="fl">1</span>, value_in_box <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     shifts_bg <span class="op">=</span> <span class="st">"white"</span>, root_bg <span class="op">=</span> <span class="st">"white"</span>, ancestral_as_shift <span class="op">=</span> <span class="cn">TRUE</span>, root_adj <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nodelabels</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="node_optimal_values-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">node_optimal_values</span><span class="op">(</span><span class="va">par</span>, <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1 2  3  4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -4 0  5 -4 0 5 5 5 0  0  0  0  0  0 -4  5  0  0  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -5 0 -3 -5 0 4 4 4 0  0  0  0  0  0 -5  4  0  0  4</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Bastide.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

