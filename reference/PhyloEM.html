<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model Estimation with Detection of Shifts — PhyloEM • PhylogeneticEM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Estimation with Detection of Shifts — PhyloEM"><meta name="description" content="PhyloEM is the main function of the package. It uses maximum likelihood
methods to fit a BM or an OU process for several traits evolving along a
phylogenetic tree, with automatic shift detection on the branches of the tree.
This function can handle missing data."><meta property="og:description" content="PhyloEM is the main function of the package. It uses maximum likelihood
methods to fit a BM or an OU process for several traits evolving along a
phylogenetic tree, with automatic shift detection on the branches of the tree.
This function can handle missing data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhylogeneticEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tutorial.html">Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/monkeys.html">New World Monkeys</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbastide/PhylogeneticEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Estimation with Detection of Shifts</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbastide/PhylogeneticEM/blob/master/R/estimateEM.R" class="external-link"><code>R/estimateEM.R</code></a></small>
      <div class="d-none name"><code>PhyloEM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>PhyloEM</code> is the main function of the package. It uses maximum likelihood
methods to fit a BM or an OU process for several traits evolving along a
phylogenetic tree, with automatic shift detection on the branches of the tree.
This function can handle missing data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PhyloEM</span><span class="op">(</span></span>
<span>  <span class="va">phylo</span>,</span>
<span>  <span class="va">Y_data</span>,</span>
<span>  process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"OU"</span>, <span class="st">"scOU"</span>, <span class="st">"rBM"</span><span class="op">)</span>,</span>
<span>  check_postorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  independent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  K_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  use_previous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method.selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LINselect"</span>, <span class="st">"DDSE"</span>, <span class="st">"Djump"</span><span class="op">)</span>,</span>
<span>  C.BM1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  C.BM2 <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  C.LINselect <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  method.variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"upward_downward"</span>, <span class="st">"simple"</span><span class="op">)</span>,</span>
<span>  method.init <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  method.init.alpha <span class="op">=</span> <span class="st">"estimation"</span>,</span>
<span>  method.init.alpha.estimation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regression"</span>, <span class="st">"regression.MM"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>  methods.segmentation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lasso"</span>, <span class="st">"best_single_move"</span><span class="op">)</span>,</span>
<span>  alpha_grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nbr_alpha <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  random.root <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stationary.root <span class="op">=</span> <span class="va">random.root</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check.tips.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progress.bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  estimates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_step <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rescale_OU <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Ncores <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  K_lag_init <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  light_result <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tol_tree <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  allow_negative <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  option_is.ultrametric <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  trait_correlation_threshold <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phylo">phylo<a class="anchor" aria-label="anchor" href="#arg-phylo"></a></dt>
<dd><p>A phylogenetic tree of class <code>phylo</code>
(from package <code><a href="https://rdrr.io/pkg/ape/man/ape-package.html" class="external-link">ape</a></code>).</p></dd>


<dt id="arg-y-data">Y_data<a class="anchor" aria-label="anchor" href="#arg-y-data"></a></dt>
<dd><p>Matrix of data at the tips, size p x ntaxa. Each line is a
trait, and each column is a tip. The column names are checked against the
tip names of the tree.</p></dd>


<dt id="arg-process">process<a class="anchor" aria-label="anchor" href="#arg-process"></a></dt>
<dd><p>The model used for the fit. One of "BM" (for a full BM model,
univariate or multivariate); "OU" (for an OU with independent traits,
univariate or multivariate); or "scOU" (for a "scalar OU" model, see details).</p></dd>


<dt id="arg-check-postorder">check_postorder<a class="anchor" aria-label="anchor" href="#arg-check-postorder"></a></dt>
<dd><p>Re-order the tree in post-order. If the Upward-Downward
algorithm is used, the tree need to be in post-order. Default to TRUE if the
upward-downward is used, otherwise automatically set to FALSE.</p></dd>


<dt id="arg-independent">independent<a class="anchor" aria-label="anchor" href="#arg-independent"></a></dt>
<dd><p>Are the trait assumed to be independent from one another?
Default to FALSE. OU in a multivariate setting only works if TRUE.</p></dd>


<dt id="arg-k-max">K_max<a class="anchor" aria-label="anchor" href="#arg-k-max"></a></dt>
<dd><p>The maximum number of shifts to be considered. Default to
\(max(|\sqrt ntaxa|, 10)\).</p></dd>


<dt id="arg-use-previous">use_previous<a class="anchor" aria-label="anchor" href="#arg-use-previous"></a></dt>
<dd><p>Should the initialization for K+1 shifts use the
estimation for $K$ shifts already obtained? Default to FALSE.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>Should the estimations be done for K increasing (TRUE) or K
decreasing (FALSE)? If use_previous=FALSE, this has no influence, except if one
initialization fails. Default to TRUE.</p></dd>


<dt id="arg-method-selection">method.selection<a class="anchor" aria-label="anchor" href="#arg-method-selection"></a></dt>
<dd><p>Method selection to be used. Several ones can be
used at the same time. One of "LINselect" for the Baraud Giraud Huet LINselect
method; "DDSE" for the Slope Heuristic or "Djump" for the Jump Heuristic, last
two based the Birgé Massart method.</p></dd>


<dt id="arg-c-bm-">C.BM1<a class="anchor" aria-label="anchor" href="#arg-c-bm-"></a></dt>
<dd><p>Multiplying constant to be used for the BigeMassart1 method.
Need to be positive. Default to 0.1.</p></dd>


<dt id="arg-c-bm-">C.BM2<a class="anchor" aria-label="anchor" href="#arg-c-bm-"></a></dt>
<dd><p>Multiplying constant to be used for the BigeMassart2 method.
Default to 2.5.</p></dd>


<dt id="arg-c-linselect">C.LINselect<a class="anchor" aria-label="anchor" href="#arg-c-linselect"></a></dt>
<dd><p>Multiplying constant to be used for the LINselect method.
Need to be greater than 1. Default to 1.1.</p></dd>


<dt id="arg-method-variance">method.variance<a class="anchor" aria-label="anchor" href="#arg-method-variance"></a></dt>
<dd><p>Algorithm to be used for the moments computations at the
E step. One of "simple" for the naive method; of "upward_downward" for the
Upward Downward method (usually faster). Default to "upward_downward".</p></dd>


<dt id="arg-method-init">method.init<a class="anchor" aria-label="anchor" href="#arg-method-init"></a></dt>
<dd><p>The initialization method. One of "lasso" for the LASSO
base initialization method; or "default" for user-specified initialization
values. Default to "lasso".</p></dd>


<dt id="arg-method-init-alpha">method.init.alpha<a class="anchor" aria-label="anchor" href="#arg-method-init-alpha"></a></dt>
<dd><p>For OU model, initialization method for the selection
strength alpha. One of "estimation" for a cherry-based initialization, using
<code><a href="https://rdrr.io/pkg/robustbase/man/nlrob.html" class="external-link">nlrob</a></code>; or "default" for user-specified
initialization values. Default to "estimation".</p></dd>


<dt id="arg-method-init-alpha-estimation">method.init.alpha.estimation<a class="anchor" aria-label="anchor" href="#arg-method-init-alpha-estimation"></a></dt>
<dd><p>If method.init.alpha="estimation",
choice of the estimation(s) methods to be used. Choices among "regression",
(method="M" is passed to <code><a href="https://rdrr.io/pkg/robustbase/man/nlrob.html" class="external-link">nlrob</a></code>); "regression.MM"
(method="MM" is passed to <code><a href="https://rdrr.io/pkg/robustbase/man/nlrob.html" class="external-link">nlrob</a></code>) or "median"
(<code><a href="https://rdrr.io/pkg/robustbase/man/nlrob.html" class="external-link">nlrob</a></code> is not used, a simple median is taken).
Default to all of them.</p></dd>


<dt id="arg-methods-segmentation">methods.segmentation<a class="anchor" aria-label="anchor" href="#arg-methods-segmentation"></a></dt>
<dd><p>For OU, method(s) used at the M step to find new
candidate shifts positions. Choices among "lasso" for a LASSO-based algorithm;
and "best_single_move" for a one-move at a time based heuristic. Default to
both of them. Using only "lasso" might speed up the function a lot.</p></dd>


<dt id="arg-alpha-grid">alpha_grid<a class="anchor" aria-label="anchor" href="#arg-alpha-grid"></a></dt>
<dd><p>whether to use a grid for alpha values. Default to TRUE. This
is the only available method for scOU. This method is not available for OU with
multivariate traits. OU with univariate traits can take both TRUE or FALSE. If
TRUE, a grid based on the branch length of the tree is automatically computed,
using function <code><a href="find_grid_alpha.html">find_grid_alpha</a></code>.</p></dd>


<dt id="arg-nbr-alpha">nbr_alpha<a class="anchor" aria-label="anchor" href="#arg-nbr-alpha"></a></dt>
<dd><p>If <code>alpha_grid=TRUE</code>, the number of alpha values on the
grid. Default to 10.</p></dd>


<dt id="arg-random-root">random.root<a class="anchor" aria-label="anchor" href="#arg-random-root"></a></dt>
<dd><p>whether the root is assumed to be random (TRUE) of fixed
(FALSE). Default to TRUE</p></dd>


<dt id="arg-stationary-root">stationary.root<a class="anchor" aria-label="anchor" href="#arg-stationary-root"></a></dt>
<dd><p>whether the root is assumed to be in the stationary
state. Default to TRUE.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>If the estimation is done with a fixed alpha (either known, or
on a grid), the possible value for alpha. Default to NULL.</p></dd>


<dt id="arg-check-tips-names">check.tips.names<a class="anchor" aria-label="anchor" href="#arg-check-tips-names"></a></dt>
<dd><p>whether to check the tips names of the tree against
the column names of the data. Default to TRUE.</p></dd>


<dt id="arg-progress-bar">progress.bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>whether to display a progress bar of the computations.
Default to TRUE.</p></dd>


<dt id="arg-estimates">estimates<a class="anchor" aria-label="anchor" href="#arg-estimates"></a></dt>
<dd><p>The result of a previous run of this same function. This
function can be re-run for other model election method. Default to NULL.</p></dd>


<dt id="arg-save-step">save_step<a class="anchor" aria-label="anchor" href="#arg-save-step"></a></dt>
<dd><p>If alpha_grid=TRUE, whether to save the intermediate results
for each value of alpha (in a temporary file). Useful for long computations.
Default to FALSE.</p></dd>


<dt id="arg-rescale-ou">rescale_OU<a class="anchor" aria-label="anchor" href="#arg-rescale-ou"></a></dt>
<dd><p>For the Univariate OU, should the tree be re-scaled to use a BM ?
This can speed up the computations a lot. However, it can make it harder for the EM to
explore the space of parameters, and hence lead to a sub-optimal solution.
Default to TRUE.</p></dd>


<dt id="arg-parallel-alpha">parallel_alpha<a class="anchor" aria-label="anchor" href="#arg-parallel-alpha"></a></dt>
<dd><p>If alpha_grid=TRUE, whether to run the
estimations with different values of alpha on separate cores. Default to
FALSE. If TRUE, the log is written as a temporary file.</p></dd>


<dt id="arg-ncores">Ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>If parallel_alpha=TRUE, number of cores to be used.</p></dd>


<dt id="arg-k-lag-init">K_lag_init<a class="anchor" aria-label="anchor" href="#arg-k-lag-init"></a></dt>
<dd><p>Number of extra shifts to be considered at the initialization
step. Increases the accuracy, but can make computations quite slow of taken
too high. Default to 5.</p></dd>


<dt id="arg-light-result">light_result<a class="anchor" aria-label="anchor" href="#arg-light-result"></a></dt>
<dd><p>if TRUE (the default), the object returned is made light,
without easily computable quantities. If FALSE, the object can be very heavy, but
its subsequent manipulations can be faster (especially for plotting).</p></dd>


<dt id="arg-tol-tree">tol_tree<a class="anchor" aria-label="anchor" href="#arg-tol-tree"></a></dt>
<dd><p>tolerance to consider a branch length significantly greater than zero, or
two lineages lengths to be different, when checking for ultrametry.
(Default to .Machine$double.eps^0.5). See <code><a href="https://rdrr.io/pkg/ape/man/is.ultrametric.html" class="external-link">is.ultrametric</a></code> and <code><a href="https://rdrr.io/pkg/ape/man/multi2di.html" class="external-link">di2multi</a></code>.</p></dd>


<dt id="arg-allow-negative">allow_negative<a class="anchor" aria-label="anchor" href="#arg-allow-negative"></a></dt>
<dd><p>whether to allow negative values for alpha (Early Burst).
See details. Default to FALSE.</p></dd>


<dt id="arg-option-is-ultrametric">option_is.ultrametric<a class="anchor" aria-label="anchor" href="#arg-option-is-ultrametric"></a></dt>
<dd><p>option for <code><a href="https://rdrr.io/pkg/ape/man/is.ultrametric.html" class="external-link">is.ultrametric</a></code> check. Default to 1.</p></dd>


<dt id="arg-trait-correlation-threshold">trait_correlation_threshold<a class="anchor" aria-label="anchor" href="#arg-trait-correlation-threshold"></a></dt>
<dd><p>the trait correlation threshold to stop the analysis. Default to 0.9.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code><a href="estimateEM.html">estimateEM</a></code>, including
tolerance parameters for stopping criteria, maximal number of iterations, etc.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>PhyloEM</code>. Relevant quantities can be extracted from it
using helper functions <code><a href="params_process.PhyloEM.html">params_process.PhyloEM</a></code>,
<code><a href="imputed_traits.html">imputed_traits.PhyloEM</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Several models can be used:</p><ul><li><p>BM with fixed root, univariate or multivariate.</p></li>
<li><p>OU with fixed or stationary root, univariate or multivariate.</p></li>
</ul><p>For the OU in the multivariate setting, two assumptions can be made:</p><ul><li><p>Independent traits. This amounts to diagonal rate and selection matrices.</p></li>
<li><p>"Scalar OU" (scOU): the rate matrix can be full, but the selection
strength matrix is assumed to be scalar, i.e. all the traits are supposed to
go to their optimum values with the same speed.</p></li>
</ul><p>Note that the "scalar OU" model can also be seen as a re-scaling of the tree.
The selection strength parameter alpha can then be interpreted as a measure
of the "phylogenetic signal":</p><ul><li><p>If alpha is close to 0, then the process is similar to a BM on the original tree,
and the signal is strong.</p></li>
<li><p>If alpha is large, then the re-scaled tree is similar to a star-tree,
and the signal is weak.</p></li>
</ul><p>When there are no shifts, and the root is taken to be constant, this
model is actually equivalent to an AC model (Uyeda et al. 2015).
With this interpretation in mind, one might want to explore
negative values of alpha, in order to fit a DC (or Early Burst) model.
With no shift and a fixed root, the same proof shows that the scOU
with alpha negative is equivalent to the DC model. There are two
strong caveats in doing that.</p><ul><li><p>The interpretation of the OU as modeling the dynamic of a trait
undergoing stabilizing selection is lost. In this case, the scOU can only
be seen as a re-scaling of the tree, similar to Pagel's delta.</p></li>
<li><p>The values of the "optimal values", and of the shifts on them, cannot
be interpreted as such (the process is actually going away from this values,
instead of being attracted). When looking at these values, one should only use
the un-normalized values happening of the underlying BM. You can extract those
using the <code><a href="params_process.html">params_process</a></code> function with <code>rBM = TRUE</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.PhyloEM.html">plot.PhyloEM</a></code>, <code><a href="params_process.PhyloEM.html">params_process.PhyloEM</a></code>,
<code><a href="imputed_traits.html">imputed_traits.PhyloEM</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Load Data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">monkeys</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Run method</span></span></span>
<span class="r-in"><span><span class="co"># Note: use more alpha values for better results.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">PhyloEM</span><span class="op">(</span>Y_data <span class="op">=</span> <span class="va">monkeys</span><span class="op">$</span><span class="va">dat</span>,        <span class="co">## data</span></span></span>
<span class="r-in"><span>               phylo <span class="op">=</span> <span class="va">monkeys</span><span class="op">$</span><span class="va">phy</span>,         <span class="co">## phylogeny</span></span></span>
<span class="r-in"><span>               process <span class="op">=</span> <span class="st">"scOU"</span>,            <span class="co">## scalar OU</span></span></span>
<span class="r-in"><span>               random.root <span class="op">=</span> <span class="cn">TRUE</span>,          <span class="co">## root is stationary</span></span></span>
<span class="r-in"><span>               stationary.root <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               K_max <span class="op">=</span> <span class="fl">10</span>,                  <span class="co">## maximal number of shifts</span></span></span>
<span class="r-in"><span>               nbr_alpha <span class="op">=</span> <span class="fl">4</span>,               <span class="co">## number of alpha values</span></span></span>
<span class="r-in"><span>               parallel_alpha <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co">## parallelize on alpha values</span></span></span>
<span class="r-in"><span>               Ncores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Plot selected solution (LINselect)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># three shifts</span></span></span>
<span class="r-in"><span><span class="co">## Plot selected solution (DDSE)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, method.selection <span class="op">=</span> <span class="st">"DDSE"</span><span class="op">)</span> <span class="co"># no shift</span></span></span>
<span class="r-in"><span><span class="co">## Extract and solution with 5 shifts</span></span></span>
<span class="r-in"><span><span class="va">params_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="params_process.html">params_process</a></span><span class="op">(</span><span class="va">res</span>, K <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, params <span class="op">=</span> <span class="va">params_5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Show all equivalent solutions</span></span></span>
<span class="r-in"><span><span class="va">eq_sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="equivalent_shifts.html">equivalent_shifts</a></span><span class="op">(</span><span class="va">monkeys</span><span class="op">$</span><span class="va">phy</span>, <span class="va">params_5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eq_sol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Bastide.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

